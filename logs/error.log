{"level":"error","message":"Connection Failed: connect ECONNREFUSED ::1:27017, connect ECONNREFUSED 127.0.0.1:27017","service":"travel-planner-api","timestamp":"2025-03-21 12:06:20"}
{"level":"error","message":"Cannot destructure property 'query' of 'req.body' as it is undefined.","service":"travel-planner-api","stack":"TypeError: Cannot destructure property 'query' of 'req.body' as it is undefined.\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:57:11\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","timestamp":"2025-03-30 01:57:59"}
{"level":"error","message":"Cannot destructure property 'query' of 'req.message' as it is undefined.","service":"travel-planner-api","stack":"TypeError: Cannot destructure property 'query' of 'req.message' as it is undefined.\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:57:11\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","timestamp":"2025-03-30 01:59:19"}
{"level":"error","message":"Cannot destructure property 'query' of 'req.message' as it is undefined.","service":"travel-planner-api","stack":"TypeError: Cannot destructure property 'query' of 'req.message' as it is undefined.\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:58:11\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","timestamp":"2025-03-30 02:00:27"}
{"level":"error","message":"Cannot destructure property 'query' of 'req.data' as it is undefined.","service":"travel-planner-api","stack":"TypeError: Cannot destructure property 'query' of 'req.data' as it is undefined.\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:58:11\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","timestamp":"2025-03-30 02:02:17"}
{"level":"error","message":"Cannot destructure property 'query' of 'req.body' as it is undefined.","service":"travel-planner-api","stack":"TypeError: Cannot destructure property 'query' of 'req.body' as it is undefined.\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:58:11\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","timestamp":"2025-03-30 02:04:36"}
{"isOperational":true,"level":"error","message":"请提供问题内容","service":"travel-planner-api","stack":"Error: 请提供问题内容\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:60:11\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","status":"fail","statusCode":400,"timestamp":"2025-03-30 02:10:06"}
{"level":"error","message":"query is not defined","service":"travel-planner-api","stack":"ReferenceError: query is not defined\n    at E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:63:69\n    at E:\\VScodeProject\\TravelPlanner\\utils\\helpers.js:3:19\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:149:13)\n    at Route.dispatch (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\route.js:119:3)\n    at Layer.handle [as handle_request] (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\layer.js:95:5)\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:284:15\n    at Function.process_params (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:346:12)\n    at next (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:280:10)\n    at Function.handle (E:\\VScodeProject\\TravelPlanner\\node_modules\\express\\lib\\router\\index.js:175:3)","timestamp":"2025-03-30 02:10:50"}
{"config":{"data":"{\"model\":\"deepseek-chat\",\"temperature\":0.7,\"max_tokens\":1000,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"best_of\":1,\"stream\":false,\"prompt\":[\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-76948d462c194ec2953200b280d04894","Content-Length":483,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"deepseek-chat\",\"temperature\":0.7,\"max_tokens\":256,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"best_of\":1,\"stream\":false,\"prompt\":[\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-76948d462c194ec2953200b280d04894","Content-Length":482,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"config":{"data":"{\"model\":\"gpt-3.5-turbo\",\"temperature\":0.7,\"top_p\":1,\"frequency_penalty\":0,\"presence_penalty\":0,\"n\":1,\"max_tokens\":1000,\"stream\":false,\"messages\":[{\"role\":\"user\",\"content\":\"\\n      你是一个友好的旅行助手。请回答用户的问题:\\n      \\n      用户问题: Do u have any suggestion for my graduation trip\\n      上下文信息: undefined\\n      \\n      请提供有帮助、友好且信息丰富的回答。如果你不确定，请诚实地说明并提供一般性建议。\\n    \"}]}","headers":{"Accept":"application/json, text/plain, */*","Authorization":"Bearer sk-FMvdi9hqoEvJPIHZB9E586F9678c4b418d3f24Bb07139616","Content-Length":499,"Content-Type":"application/json","User-Agent":"OpenAI/NodeJS/3.3.0"},"maxBodyLength":-1,"maxContentLength":-1,"method":"post","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"https://api.openai.com/v1/chat/completions","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"Request failed with status code 401","stack":"Error: Request failed with status code 401\n    at createError (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\createError.js:16:15)\n    at settle (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\core\\settle.js:17:12)\n    at IncomingMessage.handleStreamEnd (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\node_modules\\openai\\node_modules\\axios\\lib\\adapters\\http.js:322:11)\n    at IncomingMessage.emit (node:events:532:35)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:82:21)","status":401}
{"level":"error","message":"res is not defined","service":"travel-planner-api","stack":"ReferenceError: res is not defined\n    at MasterAgentService.generateGenericResponse (E:\\VScodeProject\\TravelPlanner\\services\\agents\\masterAgentService.js:247:26)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async E:\\VScodeProject\\TravelPlanner\\controllers\\masterAgentController.js:63:20","timestamp":"2025-03-30 16:17:45"}
{"level":"error","message":"Missing value for input query","service":"travel-planner-api","stack":"Error: Missing value for input query\n    at E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\prompts\\template.cjs:58:15\n    at Array.reduce (<anonymous>)\n    at Object.interpolateFString [as f-string] (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\prompts\\template.cjs:53:86)\n    at renderTemplate (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\prompts\\template.cjs:71:116)\n    at PromptTemplate.format (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\prompts\\prompt.cjs:56:49)\n    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at async PromptTemplate.formatPromptValue (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\prompts\\base.cjs:131:33)\n    at async ConversationChain._call (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\chains\\llm_chain.cjs:120:29)\n    at async ConversationChain.call (E:\\VScodeProject\\TravelPlanner\\node_modules\\langchain\\dist\\chains\\base.cjs:80:29)\n    at async MasterAgentService.generateGenericResponse (E:\\VScodeProject\\TravelPlanner\\services\\agents\\masterAgentService.js:250:20)","timestamp":"2025-03-30 21:14:48"}
{"level":"error","message":"生成通用回复失败: 422 Failed to deserialize the JSON body into the target type: messages[0]: missing field `content` at line 10 column 3","service":"travel-planner-api","timestamp":"2025-03-30 21:19:01"}
{"level":"error","message":"生成通用回复失败: 422 Failed to deserialize the JSON body into the target type: messages[0]: missing field `content` at line 10 column 3","service":"travel-planner-api","timestamp":"2025-03-30 21:21:50"}
{"level":"error","message":"保存对话历史失败: Conversation validation failed: user: Cast to ObjectId failed for value \"0001\" (type string) at path \"user\" because of \"BSONError\", trip: Cast to ObjectId failed for value \"0001\" (type string) at path \"trip\" because of \"BSONError\", response: 响应内容不能为空","service":"travel-planner-api","timestamp":"2025-03-30 22:03:38"}
{"level":"error","message":"保存对话历史失败: Conversation validation failed: response: 响应内容不能为空","service":"travel-planner-api","timestamp":"2025-03-30 22:10:07"}
{"level":"error","message":"保存对话历史失败: Conversation validation failed: response: 响应内容不能为空","service":"travel-planner-api","timestamp":"2025-03-30 23:10:19"}
{"level":"error","message":"保存对话历史失败: Conversation validation failed: response: 响应内容不能为空","service":"travel-planner-api","timestamp":"2025-03-30 23:11:43"}
